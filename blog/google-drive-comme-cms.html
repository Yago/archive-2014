<!DOCTYPE html>
<!--[if lt IE 7]>      <html class="no-js lt-ie9 lt-ie8 lt-ie7"> <![endif]-->
<!--[if IE 7]>         <html class="no-js lt-ie9 lt-ie8"> <![endif]-->
<!--[if IE 8]>         <html class="no-js lt-ie9"> <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js"> <!--<![endif]-->
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <title>Google Drive comme CMS ! | Yann Gouffon</title>
    <meta name="description" content="N'avez-vous jamais rêvé de mettre en place une petite administration pour votre site afin d'y ajouter ou d'y modifier du contenu sans douleur ? Maintenant, avec Google, c'est possible !
Google, avec son Drive, propose en effet de créer et de stocker dans le cloud des documents de plusieurs types différents;&hellip;">
    <meta name="keywords" content="yann, gouffon, Yago, Antistatique, frontend, develloper, Swiss, Suisse, designer, eikon, fribourg, lausanne, 3D, web, internet, site, graphic">
    <meta name="viewport" content="width=device-width">

    <meta property="og:title" content="Google Drive comme CMS !">
    <meta property="og:type" content="website">
    <meta property="og:url" content="/blog/google-drive-comme-cms">
            <meta property="og:image" content="/content/cover/google-drive-comme-cms.jpg">
            <meta property="og:site_name" content="Yann Gouffon">
    <meta property="og:description" content="N'avez-vous jamais rêvé de mettre en place une petite administration pour votre site afin d'y ajouter ou d'y modifier du contenu sans douleur ? Maintenant, avec Google, c'est possible !
Google, avec son Drive, propose en effet de créer et de stocker dans le cloud des documents de plusieurs types différents;&hellip;">

    <link rel="stylesheet" href="../themes/yago/build/css/vendors.css">
    <link rel="stylesheet" href="../themes/yago/build/css/yago.css">

    <script type="text/javascript" src="http://use.typekit.net/oyy3kts.js"></script>
    <script type="text/javascript">try{Typekit.load();}catch(e){}</script>

    <!--[if lt IE 9]>
      <script src="http://html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
  </head>
  <body>
        <div id="sb-site">
              <header class="covered-header">
          <nav class="navbar navbar-default" role="navigation">
            <div class="container">
              <div class="navbar-header">
                <button type="button" id="open-menu" class="navbar-toggle" aria-hidden="true">
                  <span class="sr-only">Toggle navigation</span>
                  <span class="icon-bar"></span>
                  <span class="icon-bar"></span>
                  <span class="icon-bar"></span>
                </button>
                <a class="navbar-brand" href="../index.html">
                  <img class="yago-dark" src="../themes/yago/build/img/yago-dark.svg" onerror="this.onerror=null; this.src='/themes/yago/build/img/yago-dark.png'" alt="alt" />
                  <img class="yago-light" src="../themes/yago/build/img/yago-light.svg" onerror="this.onerror=null; this.src='/themes/yago/build/img/yago-light.png'" alt="alt" />
                </a>
              </div>

              <div class="main-nav navbar-right hidden-xs" id="bs-example-navbar-collapse-1">
                <ul class="nav navbar-nav">
                  <li><a href="../index.html" title="Home">Home</a></li>
                  <li><a href="../projects.html" title="Projects">Projects</a></li>
                  <li class="active"><a href="../blog.html" title="Blog">Blog</a></li>
                </ul>
              </div>
            </div>
          </nav>
                                  <div class="img-focus"
                data-focus-x="0"
                data-focus-y="0"
                data-image-w="2880"
                data-image-h="1296">
                                                      <img src="/content/cover/google-drive-comme-cms.jpg" alt="" />
                                                </div>
                    <div class="inset-shadow" aria-hidden="true"></div>
        </header>
            
            <div class="container">
  <article>
    <div class="row">
      <div class="col-sm-8 col-sm-offset-2">
        <h1>Google Drive comme CMS !</h1>
        <div class="tags">
          <small><em>11th Mar 2014</em></small>
          <span class="text-silver">&nbsp;&nbsp;|&nbsp;&nbsp;</span>
          <small><em>
            <span class="fa fa-tags"></span>
                                        <a href="../tag/tips.html">tips</a>
                      </em></small>
        </div>
        <hr>
        <p>
            <p>N'avez-vous jamais rêvé de mettre en place une petite administration pour votre site afin d'y ajouter ou d'y modifier du contenu sans douleur ? Maintenant, avec Google, c'est possible !</p>
<p>Google, avec son Drive, propose en effet de créer et de stocker dans le cloud des documents de plusieurs types différents; des documents textes, des tableurs, des présentations et même des formulaires. Dans notre cas, nous allons utiliser les formulaires et les tableurs, ou "spreadsheet".</p>
<h2>Le concept</h2>
<p>Comme dans une administration classique, nous allons utiliser un formulaire, lié à une spreadsheet où nous irons rechercher les données précédemment entrées. </p>
<blockquote>
<p>Quelle différence avec une base de donnée ?</p>
</blockquote>
<p>Aucune, le système est le même, mais l'avantage de ce système est sa rapidité de mise en place. On pourra donc l'utiliser pour une quantité réduite de données et une structure à une table.</p>
<p>Dans notre exemple, nous allons créer une petite administration afin d'ajouter et d'afficher la liste des membres de notre association (fictive).</p>
<h2>Ajouter des membres</h2>
<p>Pour cela, nous allons commencer par créer un nouveau formulaire que nous nommerons "Ajout de membres" avec les champs nom, prénom et E-mail. Ensuite, avec "Choisir une destination pour la réponse", nous allons lui assigner une nouvelle spreadsheet que nous nommerons "Liste des membres".</p>
<p>Maintenant, vous pourriez très bien partager le <a href="https://docs.google.com/forms/d/1Le-duty7sC7hRU5vidzYpeMT_Ww7s5mU3c4k4VjXU8k/viewform">lien vers votre formulaire</a> ou simplement l'intégrer sur votre site au moyen de l'iframe proposé. Mais dans les deux cas, l'aspect visuel resterra peu convaincant.</p>
<p>Pour intégrer le formulaire directement sur notre site, il nous suffit de visiter le formulaire comme si nous souhaitions le remplir, puis, en affichant le code source de la page, copier simplement tout l'élément formulaire et le coller dans notre code.</p>
<p>Nous devrions donc avoir quelque chose comme ça :</p>
<pre><code class="language-html">&lt;form action="https://docs.google.com/forms/d/1Le-duty7sC7hRU5vidzYpeMT_Ww7s5mU3c4k4VjXU8k/formResponse" method="POST" id="ss-form" target="_self" onsubmit=""&gt;
...
&lt;/form&gt;</code></pre>
<p>Maintenant, vous constaterez surement qu'après la soumission, nous nous retrouvons avec la même page toute moche de confirmation.</p>
<p>Pour définir une page de confirmation différente, il nous suffit de remplacer le :</p>
<pre><code class="language-html">&lt;form action="https://docs.google.com/forms/d/1Le-duty7sC7hRU5vidzYpeMT_Ww7s5mU3c4k4VjXU8k/formResponse" method="POST" id="ss-form" target="_self" onsubmit=""&gt;...&lt;/form&gt;</code></pre>
<p>par :</p>
<pre><code class="language-html">&lt;script type="text/javascript"&gt;var submitted=false;&lt;/script&gt;
&lt;iframe name="hidden_iframe" id="hidden_iframe" style="display:none;" onload="if(submitted) {window.location='http://mon-site.com/ma-page-de-confirmation.html';}"&gt;&lt;/iframe&gt;
&lt;form action="https://docs.google.com/forms/d/1Le-duty7sC7hRU5vidzYpeMT_Ww7s5mU3c4k4VjXU8k/formResponse" method="post" target="hidden_iframe" onsubmit="submitted=true;"&gt;...&lt;/form&gt;</code></pre>
<p>Nous voici près à rentrer nos membres ! Maintenant, si nous souhaitions être les seuls à pouvoir accéder à ce formulaire comme dans une administration classique, rien ne nous empêche de le placer dans un répertoire protégé par un .htpasswd.</p>
<h2>Afficher les membres</h2>
<p>Avant toute chose, il nous faut nous rendre dans notre spreadsheet de résultats et la rendre consultable avec le lien (option de partage). Puis, dans Fichier/Publier sur le Web, nous allons démarrer la publication. Ce sera cette publication, duplicata de notre spreadsheet, qui sera utilisée pour afficher les données. N'oubliez pas de recopier la clé de votre document.</p>
<p>La suite est assez simple et même les profanes à PHP comprendront ! Nous allons simplement récupérer le JSON sortant de la spreasheet et afficher les éléments ligne par ligne.</p>
<p>Pour récupérer le JSON (en PHP) :</p>
<pre><code class="language-php">// Clé de la spreadsheet
$key = '0AmViBjefqXQgdG43QVJpcUhDeXU1NGpWSS1DWW9RNkE';

$spreadsheet = sprintf('https://spreadsheets.google.com/feeds/list/%s/1/public/values?alt=json', $key);
$data = json_decode(file_get_contents($spreadsheet), true);</code></pre>
<p>Maintenant, il ne reste plus qu'à faire une boucle sur chaque ligne et d'en afficher le contenu. En l'occurrence nous voulons afficher le prénom et le nom de nos membres, ainsi qu'un lien vers son adresse e-mail.</p>
<pre><code class="language-php">// Pour chaque ligne (entrée) du tableau :
foreach($data['feed']['entry'] as $row) {
  echo $row['gsx$prénom']['$t'].' '.$row['gsx$nom']['$t'].'&lt;br&gt;';
  echo '&lt;a href="mailto:'.$row['gsx$e-mail']['$t'].'"&gt;'.$row['gsx$e-mail']['$t'].'&lt;/a&gt;&lt;br&gt;';
}</code></pre>
<h2>Conclusion</h2>
<p>On peut bien évidemment aller plus loin dans la complexité, jusqu'à créer un petit moteur de blog sur ce principe. Néanmoins, il reste plus adéquat d'utiliser une "vraie" base de données dans le cas d'un site plus complexe.</p>
<p>L'avantage de ce système réside dans le fait que les données restent accessibles et éditables directement à la source pour le client. Il pourra, en effet, y faire directement ses modifications, mais aussi changer le statut d'une ligne en passant une valeur de TRUE à FALSE par exemple ;)</p>
<p><a href="http://antistatique.net/blog/2014/03/11/google-drive-comme-cms/">Retrouver cet article sur le blog d'Antistatique !</a></p>
        </p>
                  <hr>
          <div id="disqus_thread"></div>
          <script type="text/javascript">
              /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
              var disqus_shortname = 'yago-io'; // required: replace example with your forum shortname

              /* * * DON'T EDIT BELOW THIS LINE * * */
              (function() {
                  var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
                  dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
                  (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
              })();
          </script>
          <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
              </div>
    </div>
  </article>
</div>  
              <footer>
          <div class="container">
            <div class="row">
              <div class="col-sm-12 text-center">
                <hr>                <div class="spacer spacer-xs"></div>
                <h2 class="h4">Let's keep in touch</h2>
                <div class="spacer spacer-sm"></div>
                <a href="https://twitter.com/Yago_0" class="fa-stack fa-lg">
                  <i class="fa fa-circle fa-stack-2x"></i>
                  <i class="fa fa-twitter fa-stack-1x fa-inverse"></i>
                </a>
                <a href="https://github.com/Yago/" class="fa-stack fa-lg">
                  <i class="fa fa-circle fa-stack-2x"></i>
                  <i class="fa fa-github fa-stack-1x fa-inverse"></i>
                </a>
                <a href="http://ch.linkedin.com/pub/yann-gouffon/47/9a0/9bb/" class="fa-stack fa-lg">
                  <i class="fa fa-circle fa-stack-2x"></i>
                  <i class="fa fa-linkedin fa-stack-1x fa-inverse"></i>
                </a>
                <a href="http://instagram.com/yago_0" class="fa-stack fa-lg">
                  <i class="fa fa-circle fa-stack-2x"></i>
                  <i class="fa fa-instagram fa-stack-1x fa-inverse"></i>
                </a>
                <a href="https://plus.google.com/+YannGouffon/" class="fa-stack fa-lg">
                  <i class="fa fa-circle fa-stack-2x"></i>
                  <i class="fa fa-google-plus fa-stack-1x fa-inverse"></i>
                </a>
                <a href="mailto:hello@yago.io" class="fa-stack fa-lg">
                  <i class="fa fa-circle fa-stack-2x"></i>
                  <i class="fa fa-envelope fa-stack-1x fa-inverse"></i>
                </a>
                <div class="spacer spacer-xl"></div>
              </div>
            </div>
          </div>
        </footer>
      
    </div>

    <div class="sb-slidebar sb-right" aria-hidden="true">
      <ul class="nav navbar-nav">
        <li><a href="../index.html" title="Home">Home</a></li>
        <li><a href="../projects.html" title="Projects">Projects</a></li>
        <li class="active"><a href="../blog.html" title="Blog">Blog</a></li>
      </ul>
    </div>

    <script src="../themes/yago/build/js/vendors.min.js"></script>
    <script src="../themes/yago/build/js/main.js"></script>

    <script type="text/javascript">
      var _gaq = _gaq || [];
      _gaq.push(['_setAccount', 'UA-41124823-1']);
      _gaq.push(['_trackPageview']);

      (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
      })();
    </script>

    <script type="text/javascript">
      var FHChat = {product_id: "e62b17d38605"};
      FHChat.properties={};FHChat.set=function(key,data){this.properties[key]=data};FHChat.customAttributes=[];FHChat.sendCustomAttributes=function(data){this.customAttributes.push(data)};!function(){var a,b;return b=document.createElement("script"),a=document.getElementsByTagName("script")[0],b.src="https://chat-client-js.firehoseapp.com/chat-min.js",b.async=!0,a.parentNode.insertBefore(b,a)}();

      var fchatChecker = setInterval(function(){
        var $fchat = $('#fchat');
        if($('#fchat').length > 0){
          setTimeout(function(){
            $('#fchat-header-label').html('Envie de discuter ?');
            $('#fchat-message').attr('placeholder', 'Ton message');
            $('#welcome-message').html('Pour taper un petit brin de causette. À utiliser sans modération !');
          }, 500);
          clearInterval(fchatChecker);
        }
      }, 100);
    </script>

    <script type="text/javascript">
      (function($){
        $(document).ready(function(){
          emojify.setConfig({
              img_dir          : '/themes/yago/build/img/emoji',
              ignore_emoticons : true
          });
          emojify.run();
        });
      }(jQuery));
    </script>
      </body>
</html>
